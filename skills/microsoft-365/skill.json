{
  "name": "microsoft-365",
  "version": "1.0.0",
  "description": "Microsoft 365: Outlook mail (list, read, send) and Calendar (list events, create event) via Graph API",
  "env": ["MICROSOFT_CLIENT_ID", "MICROSOFT_CLIENT_SECRET", "MICROSOFT_REFRESH_TOKEN"],
  "tools": [
    {
      "name": "outlook_list_mail",
      "description": "List recent Outlook mail (inbox). Use for 'show my email', 'unread messages', 'inbox'.",
      "parameters": {
        "type": "object",
        "properties": {
          "top": {
            "type": "number",
            "description": "Number of messages to return (default 10, max 50)",
            "default": 10
          },
          "unreadOnly": {
            "type": "boolean",
            "description": "Only list unread messages",
            "default": false
          },
          "folder": {
            "type": "string",
            "description": "Folder: inbox, sentitems, drafts (default inbox)",
            "enum": ["inbox", "sentitems", "drafts"],
            "default": "inbox"
          }
        }
      }
    },
    {
      "name": "outlook_read_mail",
      "description": "Read a single Outlook message by ID. Use after outlook_list_mail to get full body.",
      "parameters": {
        "type": "object",
        "properties": {
          "messageId": {
            "type": "string",
            "description": "Message ID from outlook_list_mail"
          }
        },
        "required": ["messageId"]
      }
    },
    {
      "name": "outlook_send_mail",
      "description": "Send an Outlook email. Use for 'send email to X', 'email Y about Z'.",
      "parameters": {
        "type": "object",
        "properties": {
          "to": {
            "type": "string",
            "description": "Recipient email address (comma-separated for multiple)"
          },
          "subject": {
            "type": "string",
            "description": "Email subject"
          },
          "body": {
            "type": "string",
            "description": "Email body (plain text or HTML)"
          },
          "isHtml": {
            "type": "boolean",
            "description": "If true, body is HTML (default false)",
            "default": false
          }
        },
        "required": ["to", "subject", "body"]
      }
    },
    {
      "name": "outlook_search_mail",
      "description": "Search Outlook mail by query. Use for 'find email about X', 'search inbox for Y'.",
      "parameters": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "Search query (subject, body, from)"
          },
          "top": {
            "type": "number",
            "description": "Max results (default 10)",
            "default": 10
          }
        },
        "required": ["query"]
      }
    },
    {
      "name": "calendar_list_events",
      "description": "List Outlook calendar events. Use for 'what's on my calendar', 'today's meetings', 'events this week'.",
      "parameters": {
        "type": "object",
        "properties": {
          "startDate": {
            "type": "string",
            "description": "Start date/time ISO (e.g. 2024-01-15T00:00:00 or 2024-01-15). Default: start of today."
          },
          "endDate": {
            "type": "string",
            "description": "End date/time ISO. Default: end of same day or 7 days from start."
          },
          "top": {
            "type": "number",
            "description": "Max events to return (default 20)",
            "default": 20
          }
        }
      }
    },
    {
      "name": "calendar_create_event",
      "description": "Create an Outlook calendar event. Use for 'schedule meeting', 'add event', 'create calendar event'.",
      "parameters": {
        "type": "object",
        "properties": {
          "subject": {
            "type": "string",
            "description": "Event title"
          },
          "start": {
            "type": "string",
            "description": "Start date/time ISO (e.g. 2024-01-15T14:00:00)"
          },
          "end": {
            "type": "string",
            "description": "End date/time ISO (e.g. 2024-01-15T15:00:00)"
          },
          "body": {
            "type": "string",
            "description": "Event description/body"
          },
          "location": {
            "type": "string",
            "description": "Event location"
          },
          "attendees": {
            "type": "array",
            "description": "Attendee email addresses",
            "items": { "type": "string" }
          },
          "timeZone": {
            "type": "string",
            "description": "IANA time zone (default UTC)",
            "default": "UTC"
          }
        },
        "required": ["subject", "start", "end"]
      }
    }
  ]
}
