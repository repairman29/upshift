<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How we do human-in-the-loop (HITL) | Upshift Blog</title>
  <meta name="description" content="How Upshift does approval and oversight: prompt, webhook, or none. Config, events, and quick setup for devs who want to approve risky upgrades." />
  <meta property="og:title" content="How we do human-in-the-loop (HITL)" />
  <meta property="og:description" content="How Upshift does approval and oversight: prompt, webhook, or none. Config and quick setup for devs who want oversight." />
  <meta property="og:type" content="article" />
  <meta name="twitter:card" content="summary_large_image" />
  <link rel="icon" href="../favicon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="../styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <script defer data-domain="upshiftai.dev" src="https://plausible.io/js/script.js"></script>
  <style>
    .blog-content { max-width: 680px; margin: 0 auto; padding: 3rem 1.5rem; }
    .blog-meta { color: var(--text-muted); font-size: 0.9rem; margin-bottom: 2rem; }
    .blog-content h1 { font-size: 2.25rem; line-height: 1.2; margin-bottom: 1rem; }
    .blog-content h2 { font-size: 1.5rem; margin-top: 2.5rem; margin-bottom: 1rem; }
    .blog-content p { margin-bottom: 1.5rem; color: var(--text-muted); }
    .blog-content p:first-of-type { font-size: 1.15rem; color: var(--text); }
    .blog-content code { font-family: var(--font-mono); background: var(--bg-soft); padding: 0.15rem 0.4rem; border-radius: 4px; font-size: 0.9em; }
    .blog-content pre { background: var(--bg-soft); border: 1px solid var(--border); border-radius: var(--radius); padding: 1rem 1.25rem; overflow-x: auto; margin: 1.5rem 0; }
    .blog-content pre code { background: none; padding: 0; font-size: 0.85rem; line-height: 1.6; color: var(--accent); }
    .blog-content ul, .blog-content ol { margin-bottom: 1.5rem; padding-left: 1.5rem; color: var(--text-muted); }
    .blog-content li { margin-bottom: 0.5rem; }
    .blog-content strong { color: var(--text); }
    .blog-content hr { border: none; border-top: 1px solid var(--border); margin: 2.5rem 0; }
    .blog-content table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; font-size: 0.95rem; color: var(--text-muted); }
    .blog-content th, .blog-content td { text-align: left; padding: 0.5rem 0.75rem; border-bottom: 1px solid var(--border); }
    .blog-content th { color: var(--text); font-weight: 600; }
    .blog-cta { background: var(--bg-soft); border: 1px solid var(--border); border-radius: var(--radius); padding: 2rem; text-align: center; margin: 3rem 0; }
    .blog-cta h3 { margin: 0 0 0.5rem; }
    .blog-cta p { margin: 0 0 1rem; font-size: 1rem; }
  </style>
</head>
<body>
  <header class="header">
    <div class="wrap">
      <a href="/" class="logo">upshift</a>
      <nav>
        <a href="/#how">How it works</a>
        <a href="/#compare">vs Dependabot</a>
        <a href="/#pricing">Pricing</a>
        <a href="/blog">Blog</a>
        <a href="https://github.com/repairman29/upshift" target="_blank" rel="noopener">GitHub</a>
      </nav>
    </div>
  </header>

  <article class="blog-content">
    <p class="blog-meta">February 2026 · 6 min read</p>
    <h1>How we do human-in-the-loop (HITL)</h1>
    <p class="subtitle" style="font-size:1.1rem;color:var(--text-muted);margin-bottom:2rem;">Approval and oversight for dependency upgrades and AI-generated fixes—so you can run in auto mode when you want, and stay in the loop when you don’t.</p>

    <p>Some teams want Upshift to run fully automatic (<code>-y</code>, CI, no prompts). Others want to <strong>approve</strong> risky changes—major upgrades, package replaces, or AI-generated code fixes—before anything is applied. Here’s how we support both.</p>

    <h2>Three ways to get approval</h2>
    <p>We support three modes. You choose per project (or globally) via config.</p>
    <table>
      <thead>
        <tr><th>Mode</th><th>What happens</th><th>When to use it</th></tr>
      </thead>
      <tbody>
        <tr><td><strong>prompt</strong></td><td>CLI asks “Upgrade X from A to B (major)? [y/N]” (or “Apply? (y/n)” in batch). You answer in the terminal.</td><td>Default. Good for local dev and anyone who wants to approve major/replace before we touch files.</td></tr>
        <tr><td><strong>webhook</strong></td><td>We POST to your URL with the pending action; you respond <code>{ "approved": true }</code> or <code>false</code>. We wait (with timeout) and proceed or skip.</td><td>CI gates, team approval servers, or custom policy (e.g. “approve only if not major”).</td></tr>
        <tr><td><strong>none</strong></td><td>No approval. We apply the change (with tests and rollback as usual).</td><td>CI or scripts where you’re okay with full auto (e.g. <code>upshift upgrade --all -y</code>).</td></tr>
      </tbody>
    </table>
    <p>So: <strong>prompt</strong> = you stay in the loop in the terminal. <strong>webhook</strong> = your server or pipeline stays in the loop. <strong>none</strong> = no loop; we run and you rely on tests + rollback.</p>

    <h2>What needs approval?</h2>
    <p>You control <em>which</em> actions require approval. Typical setup:</p>
    <ul>
      <li><strong>Major upgrades</strong> — Bumping a package across a major version (e.g. React 18 → 19). Default: require approval.</li>
      <li><strong>Package replace</strong> — Swapping one package for another (e.g. <code>request</code> → <code>got</code>). Default: require approval.</li>
      <li><strong>Patch/minor</strong> — Usually safe to auto-apply; no approval by default.</li>
    </ul>
    <p>In config you set something like <code>approval.requireFor: ["major", "replace"]</code>. Then only those actions go through the approval gate (prompt or webhook). Everything else runs without asking.</p>

    <h2>Main Upshift CLI: .upshiftrc.json</h2>
    <p>For the main <code>upshift</code> CLI (scan, explain, upgrade, fix):</p>
    <ul>
      <li>Create config with <code>upshift init</code>. You get a <code>.upshiftrc.json</code> with <code>approval.mode: "prompt"</code> and <code>approval.requireFor: ["major"]</code>.</li>
      <li><strong>Single upgrade:</strong> When you run <code>upshift upgrade &lt;pkg&gt;</code> and it’s a major bump, we prompt <em>Upgrade X from A to B (major)? [y/N]</em> (unless you pass <code>-y</code> or set <code>approval.mode: "none"</code> or <code>autoConfirm: true</code>).</li>
      <li><strong>Non-interactive (e.g. CI):</strong> If approval would be required and there’s no TTY, we exit with a clear message: use <code>-y</code> to apply anyway or set <code>approval.mode: "none"</code>. We don’t silently apply major upgrades in CI unless you opt in.</li>
      <li><strong>Batch:</strong> <code>upshift upgrade --all</code> (or <code>--all-minor</code>) already asks once before applying; <code>-y</code> skips that.</li>
    </ul>
    <p>So out of the box: major upgrades get a prompt; patch/minor and <code>-y</code> skip it.</p>

    <h2>UpshiftAI: .upshiftai.json and webhooks</h2>
    <p>For the full HITL story (webhooks, event stream, approval server), we use <strong>UpshiftAI</strong> and <code>.upshiftai.json</code>:</p>
    <ul>
      <li><strong>approval.mode</strong> — <code>prompt</code> (CLI y/n), <code>webhook</code> (POST to your URL; you respond <code>{ "approved": true }</code>), or <code>none</code>.</li>
      <li><strong>approval.requireFor</strong> — e.g. <code>["replace", "major"]</code>: replace and major upgrades require approval; patch/minor do not.</li>
      <li><strong>approval.webhookUrl</strong> — Where we POST when <code>mode === "webhook"</code>. We send the pending action (pkg, targetVersion, isMajor, etc.) and wait for your JSON response.</li>
      <li><strong>webhooks</strong> — Optional list of URLs. We POST every event (checkpoint.created, apply.started, apply.completed, apply.failed, rollback.triggered, rollback.completed) so you can log, notify, or trigger your own rollback.</li>
    </ul>
    <p>Copy <code>.upshiftai.example.json</code> to <code>.upshiftai.json</code> and set your webhook URL and approval policy. Defaults already give you prompt-for-major and prompt-for-replace.</p>

    <h2>Quick setup: “I want oversight”</h2>
    <p>If you don’t want fully automatic upgrades:</p>
    <ol>
      <li><strong>Main CLI:</strong> Run <code>upshift init</code>. Don’t set <code>approval.mode: "none"</code> or <code>autoConfirm: true</code>. Don’t pass <code>-y</code> when you run upgrades. You’ll get a prompt for major upgrades.</li>
      <li><strong>UpshiftAI:</strong> Copy <code>.upshiftai.example.json</code> to <code>.upshiftai.json</code>. Leave <code>approval.mode: "prompt"</code> and <code>approval.requireFor: ["replace", "major"]</code>. Run apply without <code>--yes</code> when you want to be asked.</li>
    </ol>
    <p>Override for a single run: use <code>-y</code> or <code>--yes</code> to skip approval that time (e.g. “I’ve already reviewed; just do it”).</p>

    <h2>LLM-generated code fixes</h2>
    <p><code>upshift fix</code> suggests and can apply code changes (e.g. for breaking API updates). We treat that as human-in-the-loop by default:</p>
    <ul>
      <li><strong><code>upshift fix --dry-run</code></strong> — Preview all suggested edits. Review the diff, then run without <code>--dry-run</code> when you’re satisfied, or apply changes manually.</li>
      <li>Without <code>--dry-run</code>, we prompt “Apply N fixes? [y/N]” unless you pass <code>-y</code>.</li>
    </ul>
    <p>So: dependency upgrades can be guardrailed by tests + optional approval; LLM-generated fixes are always reviewable (dry-run or confirm) unless you explicitly use <code>-y</code>.</p>

    <hr />
    <p>Summary: we support <strong>prompt</strong>, <strong>webhook</strong>, and <strong>none</strong>. Default is prompt for major (and replace in UpshiftAI). Use config and <code>-y</code> to tune. For webhook payloads, response format, and a sample approval server, see the full <a href="https://github.com/repairman29/upshift/blob/main/upshiftai/docs/HITL.md">HITL doc</a>. For the “when it breaks” and guardrails story, see <a href="/blog/when-it-breaks-guardrails-hitl">When it breaks, who fixes it, and why human-in-the-loop still matters</a>.</p>

    <p style="margin-top:2rem;"><strong>More from the blog:</strong> <a href="/blog/introducing-upshift">Introducing Upshift</a> · <a href="/blog/when-it-breaks-guardrails-hitl">When it breaks, guardrails, and HITL</a></p>

    <div class="blog-cta">
      <h3>Try Upshift</h3>
      <p>Run with oversight by default; use <code>-y</code> when you want auto.</p>
      <a href="/start" class="btn btn-primary">Get Started</a>
    </div>
  </article>

  <footer class="footer">
    <div class="wrap">
      <p>&copy; 2026 Upshift. Built for developers who ship.</p>
    </div>
  </footer>
</body>
</html>
