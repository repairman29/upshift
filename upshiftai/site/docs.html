<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>How it works ‚Äî UpshiftAI</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="site-header">
    <div class="wrap">
      <a href="." class="logo">UpshiftAI</a>
      <nav>
        <a href=".">Home</a>
        <a href="docs.html">How it works</a>
        <a href="dev.html">Developers</a>
        <a href="pricing.html">Pricing</a>
        <a href="https://github.com/repairman29/CLAWDBOT/tree/main/upshiftai" class="nav-cta" target="_blank" rel="noopener">GitHub</a>
      </nav>
    </div>
  </header>

  <main class="docs-content">
    <div class="wrap">
      <h1>How it works ‚Äî v0.2.0</h1>
      <p><strong>NEW:</strong> Go proxy integration, pip-audit security scanning, pip automated fixes, and JARVIS conversational AI skill.</p>
      <p>UpshiftAI analyzes dependency trees across npm, pip, and Go. Flags ancient/deprecated/vulnerable packages with security audits (npm audit, pip-audit). Automated fixes with checkpoint, verify, rollback, and human-in-the-loop approval workflows.</p>

      <h2>What you can run (CLI)</h2>
      <p>Everything is executable from the CLI. Install once, then run from your project or any path:</p>
      <ul>
        <li><strong>analyze</strong> ‚Äî resolve tree, fetch registry metadata, output JSON/markdown/CSV.</li>
        <li><strong>report</strong> ‚Äî full ‚Äúdeep throat‚Äù report (direct + transitive, ‚Äúsomething old‚Äù chains, optional PDF).</li>
        <li><strong>checkpoint</strong> ‚Äî save manifest + lockfile so you can roll back later.</li>
        <li><strong>rollback</strong> ‚Äî restore from the last checkpoint.</li>
        <li><strong>apply upgrade</strong> / <strong>apply replace</strong> ‚Äî upgrade one package or replace one with another (with checkpoint, verify, auto-rollback on failure, and optional HITL/webhooks).</li>
      </ul>

      <h2>CLI reference (all commands)</h2>
      <p>Run <code>npx upshiftai-deps</code> or <code>node bin/upshiftai-deps.js</code> from the <code>upshiftai</code> directory.</p>

      <h3>analyze</h3>
      <pre class="code"><code>upshiftai-deps analyze [path] [--summary] [--exit-code] [--max-ancient=N] [--max-deprecated=N] [--markdown] [--csv] [--no-registry] [--no-audit] [--ecosystem=npm|pip|go]</code></pre>
      <p>Auto-detects npm (package-lock.json), pip (requirements.txt / pyproject.toml), or go (go.mod). Fetches GOPROXY, npm registry, PyPI metadata. Runs npm audit or pip-audit when available. Use <code>--exit-code</code> for CI gates, <code>--summary</code> for one-pager only.</p>

      <h3>report</h3>
      <pre class="code"><code>upshiftai-deps report [path] [--summary] [--json] [--diff] [--licenses] [--output FILE] [--pdf] [--pip-tree FILE.json] [--full-tree] [--no-full-tree] [--project-name NAME] [--project-url URL]</code></pre>
      <p>Full dependency report with one-pager risk assessment, security audit sections (npm audit/pip-audit), and "something old" chains. <code>--summary</code> for one-pager only. <code>--json --diff</code> compares to last run. <code>--licenses</code> adds license analysis.</p>

      <h3>checkpoint</h3>
      <pre class="code"><code>upshiftai-deps checkpoint [path] [--reason "..."]</code></pre>
      <p>Saves <code>package.json</code> + <code>package-lock.json</code> (npm) or <code>pyproject.toml</code> + <code>requirements*.txt</code> (pip) into <code>.upshiftai-tmp/checkpoints/&lt;timestamp&gt;/</code>.</p>

      <h3>rollback</h3>
      <pre class="code"><code>upshiftai-deps rollback [path] [--dry-run]</code></pre>
      <p>Restores manifest/lockfile from the latest checkpoint. Use <code>--dry-run</code> to see what would be restored.</p>

      <h3>apply upgrade</h3>
      <pre class="code"><code>upshiftai-deps apply upgrade &lt;pkg&gt; [path] [--version VER] [--dry-run] [--yes]</code></pre>
      <p>Checkpoint ‚Üí upgrade <code>&lt;pkg&gt;</code> to <code>--version</code> (default latest) ‚Üí <code>npm install</code> ‚Üí verify (<code>npm ls</code>). On failure, restores checkpoint and emits rollback events. Use <code>--yes</code> to skip approval when config requires it.</p>

      <h3>apply replace</h3>
      <pre class="code"><code>upshiftai-deps apply replace &lt;old&gt; &lt;new&gt; [path] [--version VER] [--dry-run] [--yes]</code></pre>
      <p>Checkpoint ‚Üí remove <code>&lt;old&gt;</code>, add <code>&lt;new&gt;</code> (with optional <code>--version</code>) ‚Üí install ‚Üí verify. Works for npm AND pip. Same rollback and event behavior as upgrade.</p>

      <h3>apply fix (NEW in v0.2.0)</h3>
      <pre class="code"><code>upshiftai-deps apply fix [path] [--dry-run] [--yes] [--limit N]</code></pre>
      <p>Batch automated fixes for direct ancient/deprecated deps with suggestions. Works for npm AND pip. One checkpoint for the whole run.</p>

      <h3>fix &lt;pkg&gt; (NEW in v0.2.0)</h3>
      <pre class="code"><code>upshiftai-deps fix &lt;pkg&gt; [path] [--dry-run] [--yes]</code></pre>
      <p>One-shot package upgrade/replace. Auto-detects ecosystem (npm/pip), applies suggestion if available, otherwise upgrades to latest.</p>

      <h3>health (NEW in v0.2.0)</h3>
      <pre class="code"><code>upshiftai-deps health [path] [--exit-code] [--json]</code></pre>
      <p>Quick health check: OK/WARN/FAIL status with counts (ancient, deprecated, high/critical vulns). Use <code>--exit-code</code> for CI integration.</p>

      <h2>Config: webhooks &amp; HITL</h2>
      <p>Put <code>.upshiftai.json</code> in the project root (or set <code>UPSHIFTAI_CONFIG</code> or use <code>--config path</code>). Copy from <code>.upshiftai.example.json</code>.</p>
      <pre class="code"><code>{
  "webhooks": ["https://your-server.com/hooks/upshiftai"],
  "approval": {
    "mode": "prompt",
    "requireFor": ["replace", "major"],
    "webhookUrl": "https://your-server.com/approve",
    "timeoutMs": 60000
  }
}</code></pre>
      <ul>
        <li><strong>webhooks</strong> ‚Äî we POST every event (checkpoint.created, apply.started, apply.completed, apply.failed, rollback.triggered, rollback.completed) to these URLs. Your endpoint can run <code>upshiftai-deps rollback</code> or your own revert on <code>rollback.triggered</code> / <code>apply.failed</code>.</li>
        <li><strong>approval.mode</strong> ‚Äî <code>prompt</code> (CLI ‚Äúy/n‚Äù), <code>webhook</code> (POST to <code>webhookUrl</code>; we wait for <code>{ "approved": true }</code>), or <code>none</code>.</li>
        <li><strong>approval.requireFor</strong> ‚Äî e.g. <code>["replace", "major"]</code>: replace and major upgrades require approval; patch/minor can run without.</li>
      </ul>

      <h2>Signals in the report</h2>
      <table>
        <thead>
          <tr><th>Signal</th><th>Meaning</th></tr>
        </thead>
        <tbody>
          <tr><td>age</td><td>Months since last publish (e.g. &gt;24 = ancient).</td></tr>
          <tr><td>deprecated</td><td>npm <code>deprecated</code> or PyPI deprecated classifier.</td></tr>
          <tr><td>fork_hint</td><td>Package name suggests a fork (<code>-fork</code>, <code>-legacy</code>, etc.).</td></tr>
          <tr><td>oldPython</td><td>requires_python indicates Python 2 or very old 3.x.</td></tr>
          <tr><td>depth</td><td>Depth in tree (root = 0).</td></tr>
          <tr><td>why</td><td>Which parent(s) pulled in this package.</td></tr>
        </tbody>
      </table>

      <h2>Output formats</h2>
      <ul>
        <li><strong>JSON</strong> ‚Äî default for <code>analyze</code>; full report for pipelines.</li>
        <li><strong>--markdown</strong> ‚Äî human-readable table of problematic packages.</li>
        <li><strong>--csv</strong> ‚Äî spreadsheet: name, version, depth, ancient, deprecated, forkHint, reasons, replacement, note.</li>
        <li><strong>report</strong> ‚Äî full markdown (and optional <code>--output FILE</code>, <code>--pdf</code>).</li>
      </ul>

      <h2>Integration</h2>
      <ul>
        <li><strong>upshiftai.dev</strong> ‚Äî Call the CLI or <code>import { analyze, applyNpmUpgrade, ... } from 'upshiftai-deps'</code> and use JSON/events for upgrade suggestions, replace flows, or PR automation.</li>
        <li><strong>JARVIS / CLAWDBOT</strong> ‚Äî ü§ñ **Pro subscription required**. Install the skill, set API key, and ask JARVIS to analyze dependencies conversationally.</li>
        <li><strong>CI</strong> ‚Äî Run <code>analyze</code> and gate on ancient/deprecated count; run <code>apply</code> with <code>--yes</code> and webhooks for observability and rollback.</li>
      </ul>

      <h2>Documentation index</h2>
      <ul>
        <li><a href="dev.html">Developers</a> ‚Äî install, CLI at a glance, config, programmatic API, CI, webhooks, env vars.</li>
        <li><a href="pricing.html">Pricing &amp; packaging</a> ‚Äî tiers (Free / Pro / Team), packaging (CLI, npm, open source).</li>
        <li><strong>README</strong> (repo) ‚Äî quick start, all command summaries, config.</li>
        <li><strong>docs/DESIGN-SUGGESTIONS-AUTOMATIONS.md</strong> ‚Äî who benefits, suggestions, automations, HITL, webhooks, rollbacks.</li>
        <li><strong>.upshiftai.example.json</strong> ‚Äî example config for webhooks and approval.</li>
      </ul>

      <h2>Roadmap</h2>
      <ul>
        <li>npm lockfile + registry metadata (done)</li>
        <li>Ancient/legacy/fork heuristics (done)</li>
        <li>pip requirements.txt + pyproject.toml + PyPI metadata (done)</li>
        <li>go mod (done)</li>
        <li>Full report + transitive ‚Äúsomething old‚Äù chains (done)</li>
        <li>Checkpoint &amp; rollback (done)</li>
        <li>Apply upgrade/replace + HITL + webhooks (done)</li>
        <li>Suggest replacements npm + pip (done)</li>
        <li>pip apply (upgrade/replace) (done)</li>
        <li><strong>v0.2.0 NEW:</strong> Go proxy metadata, pip-audit security, pip apply fix/fix &lt;pkg&gt;, JARVIS skill (done)</li>
      </ul>
    </div>
  </main>

  <footer class="site-footer">
    <div class="wrap">
      <p><a href=".">UpshiftAI</a> ‚Äî ancient dependency lineage. Part of the <a href="https://github.com/repairman29/CLAWDBOT" target="_blank" rel="noopener">CLAWDBOT</a> ecosystem. <a href="https://github.com/sponsors/repairman29" target="_blank" rel="noopener">Sponsor</a> ¬∑ <a href="pricing.html">Pricing</a></p>
    </div>
  </footer>
</body>
</html>
